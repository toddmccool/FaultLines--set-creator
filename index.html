<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Faultlines Setlist Maker</title>

    <style>
      html,
      body {
        height: 100%; /* Ensure the html and body are at least the height of the viewport */
        margin: 0; /* Remove default margin */
        padding: 0; /* Remove default padding */
        background-image: url("fll.jpg"); /* Path to your image file */
        background-size: cover; /* Cover the entire page */
        background-position: right 20% center; /* Center the background image */
        background-repeat: no-repeat; /* Do not repeat the image */
      }
      body {
        display: flex; /* Use flex to manage children */
        flex-direction: column; /* Organize children vertically */
        min-height: 100vh; /* Minimum height as 100% of the viewport height */
      }
      textarea,
      button {
        width: 90%;
        margin: 10px auto; /* Centering buttons and textarea */
        display: block;
      }
      button[onclick="copySetlist()"] {
        margin-top: -80px; /* Adjust as necessary to bring it up by approximately three lines */
      }

      #listsContainer {
        display: flex;
        flex-wrap: wrap; /* Allows the container to wrap on smaller screens */
        justify-content: space-between;
        flex-grow: 1; /* Allows container to expand to fill available space */
      }
      #masterList,
      #setList {
        width: 100%; /* Full width on smaller screens */
        border: 1px solid black;
        padding: 10px;
        margin: 10px 0; /* Only vertical margin */
        height: 400px; /* Adjust height as necessary */
        overflow-y: auto; /* Enables scrolling */
        background-color: white; /* Sets background color for the lists */
      }
      .song {
        margin: 5px;
        padding: 5px;
        border: 1px solid grey;
        cursor: pointer;
        background-color: white; /* Ensures song titles have a white background */
      }
      .song:hover {
        background-color: lightgrey;
      }

      /* Responsive adjustments */
      @media (min-width: 480px) {
        #masterList,
        #setList {
          width: 48%; /* Two columns on smaller screens */
          margin: 10px 1%; /* Small side margins for gutter space */
        }
        #listsContainer {
          justify-content: space-around;
        }
      }

      @media (min-width: 768px) {
        #masterList,
        #setList {
          width: 45%; /* Slightly larger than on smaller devices */
        }
      }

      @media (min-width: 1024px) {
        #listsContainer {
          justify-content: space-around;
        }
      }
    </style>
  </head>
  <body>
    <textarea id="songInput" rows="10" cols="50">

      Ain’t Nobody/In The Air / 104 bpm capo 6
      Ain’t no mountain 129 bpm capo 0
      All My Lovin ballad version 156 bpm capo 4
      American Boy E 115 bpm capo 0
      American Girl D 115 bpm capo 0
      And I Love Her Beatles 113 bpm capo 0 
      Animals Medley 148 bpm capo 0
      Any way you want it capo 0 138 bpm
      Are You Gonna Be My Girl 105 bpm capo 2
      As It Was 174 bpm capo 0
      At Last 87 bpm capo 0
      Baby its cold outside 86 bpm G capo 3
      Bad Habits 126 bpm capo 2
      Bad bad Leroy Brown 148 bpm capo 3
      Believe E _Do you believe in life after love Cher  133 bpm capo 0 
      Benny and the Jets 72 bpm capo 0
      Best Day Of My Life 100 bpm capo 1
      Billie Jean 120 bpm capo 0
      Black Velvet Emi 85 bpm capo 0
      Blackbird 94 bpm capo 0
      Blackhorse and a cherry tree 105 bpm capo 0
      Bless the broken road  68 bpm capo 0
      Blister In The Sun 97 bpm capo 0
      Brandy 125 bpm capo 0
      Brass in Pocket the pretenders 107 bpm capo 0
      Breakfast at tiffanys 113 bpm capo 0
      Broken Hearted/Just The Way You Are/YMCA 120 bpm capo 1
      Brown eyed girl i’m a believer 154 bpm capo 0
      Burn/Cheap Thrills capo 2 174 bpm
      Cake by the Ocean Emi 119 bpm capo 0
      California Dreamin 113 bpm capo 2
      California Girls capo 5 125 bpm
      Can’t Hurry Love 196 bpm capo 3
      Can’t stop the feelin’ 113 bpm capo 0
      Carolina 75 bpm capo 2
      Carry On My Wayward Son Ami 125 bpm capo 0
      Chasing Cars 109 bpm capo 2
      Cheap Thrills 90 bpm capo 2
      Close To You they long to be 88 bpm capo 0
      Closer C capo 1 95 bpm 
      Come and Get your love D ii V I vi 107 bpm capo 0
      Crazy Bb patsy klein 71 bpm capo 0
      Crazy Gnarls Barkley capo 112 bpm capo 3
      Crazy In Love Bb 99 bpm capo 0
      Crazy Love capo 0 77 bpm
      Crazy in love 99 bpm G E capo 3
      Crazy little thing called love D 154 bpm capo 0
      Cry me a river v / ch Emi B capo 2
      Dance monkey 98 bpm capo 2
      Dancin on my own Robyn 117 bpm capo 4
      Dancing In the Dark Bruce S. 149 bpm capo 4
      Daniel 132 bpm capo 0
      Deez Boots Were Made ,capo 0 
      saw her standing there 162 bpm capo 0 81 bpm capo 0
      sedated 163 bpm capo 0  82 bpm capo 0
      Runnin down a Dream 170 bpm capo 0  85 bpm
      Domino capo 127 bpm capo 2
      Don’t Know Why 89 bpm capo 3
      Don’t Stop Believing Journey 188 bpm capo 4
      Don’t start now 124 bpm capo 0
      Don’t original  /  capo 1
      Dream On capo capo 1
      Dreams /little red corvette/I’ll be around/Rebel rebel/Don’t you want me baby 120 bpm capo 0
      Easy 133 bpm capo 0  67 bpm capo 0 
      Enough    original  /  capo 3
      Every littleThing she does isMagic 82 bpm capo 0
      Everybody Talks capo 155 bpm capo 3
      Ex’s and Oh’s Emi  130 bpm capo 0
      Faith (with footloose/karma chameleon) 174 bpm capo 0
      Faith (original tempo) 164 bpm capo 0
      Fast Car capo 104 bpm capo 2
      Fat Bottom girls _ 87 bpm capo 0 capo -2  174 bpm capo -2
      February capo capo 3
      Feel It Still/hit the road jack 79 bpm capo 4  158 bpm  
      Feel for you Bmi 125 bpm capo 2
      Fever Ami 135 bpm capo 0  68 bpm
      Fire & Rain 76 bpm capo 3
      Flowers 118 bpm capo 0
      Fly me to the moon capo 3
      Footloose 174 bpm capo 0
      Funky Music /I Wish/Superstition/Stayin Alive/Get Down Tonight/ 106 bpm capo 0
      Georgia on my mind G  105 bpm capo 0
      Get Lucky 116 bpm capo 2
      Go Your Own Way    G…D C…Ch:  /  136 bpm capo 0
      Go put your records on A 95 bpm capo 0
      God Only knows capo 2
      Hallelujah 97 bpm capo 7
      Happy Together Emi 108 bpm capo 2
      Happy capo 160 bpm capo 1
      Harvest Moon D 113 bpm capo 0
      Here comes the sun D 128 bpm capo 7
      Heroes Alesso 126 bpm capo 2
      heyYa G mix 155 bpm capo 0
      Hit the road/tainted love 144 bpm capo 4
      Ho Hey C 80 bpm capo 0
      Hotel California Eagles 74 bpm capo 2
      How Deep Is Your Love beegees 105 bpm capo 3
      I Wanna Dance With Somebody E 119 bpm capo 1
      I cant help falling in love 100 bpm capo 4
      If you only knew    original G chords /  capo 2
      I’d rather go blind A tennessee whiskey 98 bpm capo 0
      I’m a Believer brown eyd grl 155 bpm capo 0
      Jailhouse rock 167 bpm capo 0
      Jolene 111 bpm capo 4
      Just A Girl D _ 108 bpm capo 0
      Just The Way You Are Billy Joel 139 bpm capo 0
      Karma chameleon 184 bpm capo 0 92 bpm
      Karma chameleon (w/Footloose/faith) 174 bpm capo 0 87 bpm
      Killing me softly Emi _92 bpm capo 0
      Kiss Me  _ 100 bpm capo 3
      Kiss me ½ step down (D) 100 bpm capo 0  
      L.O.V.E    key of D /  112 bpm capo 0
      Landslide G _ 159 bpm capo 7  _  79 bpm
      Lets stay together F _ 102 bpm  capo 0
      Levitating 103 bpm capo 0
      Listen to the music    E -> F /  107 bpm capo 1
      Locked Out Of Heaven Heaven capo capo 4
      Long Run    original /  capo capo 3
      Long Train Runnin 117 bpm capo 2
      Long Way for now    original /  capo 3
      Love Me Like You Do 95 bpm capo 0
      Love Never Felt So Good 120 bpm capo 0
      Love Supply    original /  capo 1
      Love Yourself 107 bpm capo 4
      Love is all we own    original /   capo 2
      Lovefool 112 bpm capo 0
      Lovesong Adele Version 117 bpm capo 3
      Make You Feel My Love 77 bpm capo 3
      Mary Janes Last Dance  85 bpm capo 0
      Me & NYC    original /    capo 1
      Melt With You C 154 bpm capo 0
      Moon river C capo 0
      Moondance 134 bpm capo 0
      Moves Like Jagger Bmi 120 bpm capo 0
      Mr. blue sky F capo 0
      Natural Woman G chromatic walk down pre: ii iii  _ 111 bpm capo 2 
      No Matter What _ w/you / won’t you / want you / w/you / want you / want you / 116 bpm capo 0
      Oh what a night 104 bpm capo 6
      Only The Good Die Young William Joel 76 bpm capo 0
      PYT  127 bpm capo 2
      Paper Planes    original /  capo 2
      Peaceful Easy Feeling 143 bpm capo 0
      Penny lane 114 bpm capo 2
      Physical 124 bpm capo 0
      Picture Perfect    original /  capo 6
      Pour some sugar on me E capo 0
      Price Tag/Where Is The Love/party in the USA / _ 88 bpm capo 1
      Rainbow 65 bpm capo 3
      Rather Be  121 bpm capo 4
      Rhiannon Ami 129 bpm capo 0
      Rock this town D 202 bpm capo 0
      Rocket Man 70 bpm capo 3
      Rolling In The Deep 115 bpm capo 0
      Runaway To Mars 119 bpm capo 3
      Satisfaction E blues 136 bpm capo 0
      Save tonight Ami 120 bpm capo 0
      Send Me On My Way 115 bpm capo 0
      September_F/G |v: C Bmi Ami Bmi Emi |ch Ami D Bmi Emi _ 126 bpm capo 2
      Shut up and dance /she drives me crazy C 128 bpm capo 1
      Sister Golden Hair America E capo 0
      Smells Like Teen Spirit 130 bpm capo 1
      Somewhere Only We Know 86 bpm capo 2
      Son Of A Preacher Man Dusty Springfield 91 bpm capo 0
      Sorry capo 100 bpm capo 3
      Space Oddity C _ 136 bpm capo 0
      Stand By Me /Dock of the Bay/Every Breath u take 119 bpm capo 0
      Starting at the finish line G capo 3
      Stay with me 84 bpm capo 0
      Still The One Shania Twain 67 bpm capo 0 134 bpm
      Stuck in the middle 95 bpm capo 0
      Style t swift 95 bpm capo 2
      Suit and tie 99 bpm capo 0
      Summer Of 136 bpm capo 0
      Sunday Morning 88 bpm capo 0
      Sweet Dreams havana 125 bpm capo 3
      Sweet caroline 126 bpm capo 2
      Tainted Love capo 144 bpm capo 2
      Take It Easy Eagles 139 bpm capo 0
      Take me home country Road 82 bpm capo 2
      Teenage Dream G_ 120 bpm capo 0
      Tennessee whiskey 98 bpm capo 0
      The First Cut is the Deepest Cat Stevens/Sheryl 80 bpm capo 0
      The Heart Wants What It Wants capo capo 3
      The Way You Make Me Feel capo capo 2
      The way you look tonight Eb 133 bpm capo 0
      This Love _ 95 bpm capo 3
      Time after time C 130 bpm capo 0
      Time in a Bottle capo 5
      Tiny Dancer 145bpm capo 0
      Titanium/Young & Beautiful/Clarity 126 bpm capo 3
      Treasure capo 116 bpm capo 3
      Umbrella C capo 0
      Unforgettable F capo 0
      Up Around The Bend CCR 130 bpm capo 0
      Valerie Eb 105 bpm capo 3
      Wagon Wheel capo 148 bpm capo 2
      Waiting for you C capo 0
      Wasabi Dream capo 0
      Watermelon sugar Dmi 95 bpm capo 0
      We Are Young capo 92 bpm capo 1
      We Found Love/Latch 128 bpm capo 5
      We are family 116 bpm capo 0
      What a wonderful world F original/male key capo 0
      What i like about you E_ 161 bpm capo 0
      Whats Goin On 102 bpm capo 0
      While My Guitar Gently Weeps  118 bpm capo 0
      Whole Lotta Love 88 bpm capo 0
      Wide Open Spaces 90 bpm capo 2
      Wild World 76 bpm capo 0
      Wish You Were Here C capo 6
      Wonderwall 88 bpm capo 2
      Wooden bridges G capo 2
      Yellow brick road 121 bpm capo 1
      Yesterday capo 0
      You Gotta Be Angel Of Mine Human Nature 94 bpm capo 0
      You may be right key of A 150 bpm capo 0
      You’re Still The One Shania Twain capo 1
      i feel the earth move 120 bpm capo 0
      i wanna be your Lover   C G Emi …. C Bmi Emi /  capo 4 115 bpm
      the Climb 161 bpm capo 2
      you’re no good 105 bpm capo 0
      you’re so vain 106 bpm capo 0
</textarea
    ><br />
    <button onclick="parseSongs()">Load Songs</button>
    <div id="listsContainer">
      <div id="masterList" tabindex="0"></div>
      <div id="setList"></div>
    </div>
    <button onclick="copySetlist()">Copy Setlist</button>

    <script>
      let originalSongs = [];
      let masterSongs = [];
      let setList = [];

      function parseSongs() {
        const input = document.getElementById("songInput").value.split("\n");
        originalSongs = input.map((line, index) => {
          const name = line.replace(/(\d+ bpm|capo \d+)/g, "").trim();
          const bpmMatch = line.match(/(\d+) bpm/);
          const bpm = bpmMatch ? parseInt(bpmMatch[1]) : null;
          const capoMatch = line.match(/capo (\d+)/);
          const capo = capoMatch ? parseInt(capoMatch[1]) : null;
          return { id: index, name, bpm, capo, originalIndex: index };
        });
        masterSongs = [...originalSongs];
        displaySongs("masterList", masterSongs);
        document.getElementById("songInput").style.display = "none"; // Optionally hide the input textarea
        document.querySelector("button[onclick='parseSongs()']").style.display =
          "none"; // Hide the Load Songs button
      }

      function displaySongs(containerId, songs) {
        const container = document.getElementById(containerId);
        container.innerHTML = "";
        songs.forEach((song) => {
          const songDiv = document.createElement("div");
          songDiv.className = "song";
          songDiv.textContent = `${song.name} ${
            song.bpm ? "- " + song.bpm + " bpm" : ""
          } ${song.capo !== null ? "- capo " + song.capo : ""}`;
          songDiv.onclick = () => {
            containerId === "masterList"
              ? selectSong(song)
              : deselectSong(song);
          };
          if (containerId === "setList") {
            songDiv.ondblclick = () => moveSongUp(song);
          }
          container.appendChild(songDiv);
        });
      }

      function selectSong(song) {
        setList.push(song);
        masterSongs = masterSongs.filter((s) => s.id !== song.id);
        updateSuggestions();
        displaySongs("setList", setList);
        displaySongs("masterList", masterSongs);
        const masterListContainer = document.getElementById("masterList");
        masterListContainer.scrollTop = 0; // Scroll to the top
        masterListContainer.focus(); // Set focus back to the master list
      }

      function deselectSong(song) {
        masterSongs.splice(song.originalIndex, 0, song); // Insert song back into its original position
        setList = setList.filter((s) => s.id !== song.id);
        updateSuggestions();
        displaySongs("setList", setList);
        displaySongs("masterList", masterSongs);
      }

      function moveSongUp(song) {
        const index = setList.indexOf(song);
        if (index > 0) {
          [setList[index - 1], setList[index]] = [
            setList[index],
            setList[index - 1],
          ];
          displaySongs("setList", setList);
        }
      }

      function updateSuggestions() {
        if (!setList.length) return;
        const lastSelectedSong = setList[setList.length - 1];

        masterSongs.sort((a, b) => {
          const capoMatchA = a.capo === lastSelectedSong.capo ? 0 : 100;
          const capoMatchB = b.capo === lastSelectedSong.capo ? 0 : 100;
          const bpmDiffA = Math.abs(a.bpm - lastSelectedSong.bpm);
          const bpmDiffB = Math.abs(b.bpm - lastSelectedSong.bpm);
          const exactMatchA = capoMatchA === 0 && bpmDiffA <= 3 ? 0 : 1;
          const exactMatchB = capoMatchB === 0 && bpmDiffB <= 3 ? 0 : 1;

          return (
            exactMatchA - exactMatchB ||
            capoMatchA - capoMatchB ||
            bpmDiffA - bpmDiffB
          );
        });

        displaySongs("masterList", masterSongs);
      }

      function copySetlist() {
        const setListSongs = setList
          .map(
            (song) =>
              `${song.name} - ${song.bpm ? song.bpm + " bpm" : ""} ${
                song.capo !== null ? "- capo " + song.capo : ""
              }`
          )
          .join("\n");
        navigator.clipboard.writeText(setListSongs).then(
          () => alert("McCool-i-fied Setlist copied to clipboard!"),
          (err) => console.error("Failed to copy setlist: ", err)
        );
      }
    </script>
  </body>
</html>
